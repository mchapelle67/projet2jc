<!-- Menu Burger (visible uniquement mobile) -->
<div class="burger-menu">
    <button class="burger-toggle" id="burger-toggle" aria-label="Menu">
        <span class="burger-line"></span>
        <span class="burger-line"></span>
        <span class="burger-line"></span>
    </button>
</div>

<!-- Menu mobile (cachÃ© par dÃ©faut) -->
<nav class="mobile-nav" id="mobile-nav">
    <div class="mobile-nav-overlay"></div>
    <div class="mobile-nav-content">
        <div class="burger-menu-close">
            <button class="burger-close-icon" id="burger-close" aria-label="Fermer">
                <i class="fa-solid fa-xmark fa-2xl"></i>
            </button>
        </div>
        
        <ul class="mobile-nav-links">
            {% if is_granted('ROLE_USER')%}
            <li class="nav-item dropdown ms-auto">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLinkAdmin" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <i class="fa-solid fa-user fa-lg" style="opacity: 1;"></i>          
                </a>
                <div class="dropdown-menu dropdown-menu-start" aria-labelledby="navbarDropdownMenuLinkAdmin">
                    {% if is_granted('ROLE_SUPER_ADMIN') %}
                    <a class="dropdown-item" href="{{ path('dashboard_admin') }}">SUPER ADMIN</a>
                    {% endif %}
                            <a class="dropdown-item" href="{{ path('app_admin_rdv_calendar') }}">Calendrier rdv</a>
                            <a class="dropdown-item" href="{{ path('app_rdv_historique') }}">Rdv historique</a>
                            {% if is_granted('ROLE_ADMIN')%}
                            <a class="dropdown-item" href="{{ path('app_devis_historique') }}">Devis historique</a>
                            <a class="dropdown-item" href="{{ path('app_admin_rdv') }}">Rdv en attente</a>
                            <a class="dropdown-item" href="{{ path('app_admin_devis') }}">Devis en attente</a>
                    {# <a class="dropdown-item" href="{{ path('add_vo') }}">Ajouter VO</a> #}
                    {% endif %}
                    <a class="dropdown-item" href="{{ path('app_logout') }}">Deconnexion</a>
                </div>
            </li>
            {% endif %}
            <li><a href="{{ path('app_home') }}"><i class="fa-solid fa-house"></i>Accueil</a></li>
            <li><a href="{{ path('app_services') }}"><i class="fa-solid fa-wrench"></i>Nos services</a></li>
            <li><a href="{{ path('app_devis_client') }}"><i class="fa-solid fa-file"></i>Devis</a></li>
            <li><a href="{{ path('app_rdv_client') }}"><i class="fa-solid fa-calendar-days"></i>Rendez-vous</a></li>
            {# <li><a href="{{ path('app_vo') }}"><i class="fa-solid fa-car"></i>Voitures d'occasions</a></li> #}
            <li><a href="{{ path('app_contact') }}"><i class="fa-solid fa-at"></i>Contact</a></li>
            <li><a href="{{ path('app_home')}}#localisation"><i class="fa-solid fa-location-dot"></i>Nous trouver</a></li>
            <li><a href="tel:0389400000"><i class="fa-solid fa-phone"></i> +33 3 89 40 00 00</a></li>
            <li class="social-links-container">
                <a href="https://www.facebook.com/p/2jc-Automobiles-100063767071947/?locale=fr_FR" aria-label="Facebook" class="social-link">
                    <i class="fa-brands fa-facebook fa-xl"></i>
                </a>
                <a href="https://www.instagram.com/2jc_automobiles/" aria-label="Instagram" class="social-link">
                    <i class="fa-brands fa-instagram fa-xl"></i>
                </a>
            </li>
        </ul>
    </div>
</nav>
 <script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('ðŸ”¥ Script chargÃ©');
    
    const burgerToggle = document.getElementById('burger-toggle');
    const burgerClose = document.getElementById('burger-close'); 
    const mobileNav = document.getElementById('mobile-nav');
    const overlay = document.querySelector('.mobile-nav-overlay');
    
    console.log('Ã‰lÃ©ments trouvÃ©s:', {
        burgerToggle: !!burgerToggle,
        burgerClose: !!burgerClose, 
        mobileNav: !!mobileNav,
        overlay: !!overlay
    });
    
    // Ouvrir
    if (burgerToggle) {
        burgerToggle.addEventListener('click', function(e) {
            e.preventDefault();
            console.log('ðŸŸ¢ OUVERTURE');
            mobileNav.classList.add('open');
            burgerToggle.classList.add('active');
            document.body.classList.add('menu-open');
            document.body.style.overflow = 'hidden';
        });
    }
    
    // âœ… UNE SEULE fonction closeMenu
    function closeMenu() {
        console.log('ðŸ“ž closeMenu() appelÃ©e');
        if (mobileNav) {
            mobileNav.classList.remove('open');
            console.log('âœ… Classe "open" supprimÃ©e');
        }
        if (burgerToggle) {
            burgerToggle.classList.remove('active');
            console.log('âœ… Classe "active" supprimÃ©e');
        }
        document.body.classList.remove('menu-open');
        document.body.style.overflow = '';
        console.log('âœ… Overflow restaurÃ©');
    }
    
    // Fermer avec la croix
    if (burgerClose) {
        burgerClose.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            console.log('ðŸ”´ FERMETURE CROIX');
            closeMenu();
        });
    } else {
        console.error('âŒ Bouton fermer NON TROUVÃ‰ !');
    }
    
    // Fermer avec overlay
    if (overlay) {
        overlay.addEventListener('click', function(e) {
            console.log('ðŸ”´ FERMETURE OVERLAY');
            closeMenu();
        });
    }
    
    // âœ… MODIFIE cette partie pour permettre le dropdown
    const mobileNavContent = document.querySelector('.mobile-nav-content');
    if (mobileNavContent) {
        mobileNavContent.addEventListener('click', function(e) {
            // âœ… AUTORISE les clics sur les dropdowns
            if (!e.target.closest('.dropdown') && !e.target.closest('.dropdown-menu')) {
                e.stopPropagation();
            }
        });
    }
    
    // âœ… AJOUTE la gestion spÃ©cifique du dropdown
    const dropdownToggle = document.getElementById('navbarDropdownMenuLinkAdmin');
    const dropdownMenu = document.querySelector('.dropdown-menu');
    
    if (dropdownToggle && dropdownMenu) {
        dropdownToggle.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            console.log('ðŸ”½ TOGGLE DROPDOWN');
            
            // Toggle du dropdown
            if (dropdownMenu.style.display === 'block') {
                dropdownMenu.style.display = 'none';
            } else {
                dropdownMenu.style.display = 'block';
            }
        });
        
        // Fermer le dropdown quand on clique sur un item
        const dropdownItems = dropdownMenu.querySelectorAll('.dropdown-item');
        dropdownItems.forEach(item => {
            item.addEventListener('click', function() {
                console.log('ðŸ”— CLIC DROPDOWN ITEM - FERMETURE MENU');
                dropdownMenu.style.display = 'none';
                closeMenu(); // Ferme aussi le menu mobile
            });
        });
    }
});
</script>